
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>NOAA Format &#8212; Big Data, Xiangfei Education Group, UW Summer 2018 1 documentation</title>
    <link rel="stylesheet" href="_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Using Map Reduce to find the average tempeartures for each state" href="lesson4_3.html" />
    <link rel="prev" title="Introduction to NOAA Dataset" href="lesson4.html" /> 
  </head><body>
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="index.html">Big Data, Xiangfei Education Group, UW Summer 2018 1 documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="lesson4.html" title="Introduction to NOAA Dataset"
             accesskey="P">previous</a> |
          <a href="lesson4_3.html" title="Using Map Reduce to find the average tempeartures for each state"
             accesskey="N">next</a> |
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="noaa-format">
<span id="lesson4-2"></span><h1>NOAA Format<a class="headerlink" href="#noaa-format" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction-to-the-noaa-fixed-character-format">
<h2>Introduction to the NOAA fixed character format<a class="headerlink" href="#introduction-to-the-noaa-fixed-character-format" title="Permalink to this headline">¶</a></h2>
<img alt="_images/isd_example.png" src="_images/isd_example.png" />
<ul class="simple">
<li>Most of the records always occurr in the same position. Or example, the temperatuer occurs from character 88 to character 92</li>
<li>Some of the records have to divided. For example, the temperature is in Celcius, multiplied by 10. The real values is
242/10 = 24.2 C</li>
<li>Missing data is represented by special numbers. For example, “9999” means there is no data. We have to ignore
these records</li>
<li>The full set is here: <a class="reference external" href="https://s3.console.aws.amazon.com/s3/buckets/paulhtremblay/noaa/data/?region=us-east-1&amp;tab=overview">https://s3.console.aws.amazon.com/s3/buckets/paulhtremblay/noaa/data/?region=us-east-1&amp;tab=overview</a></li>
<li>Samples are here: <a class="reference external" href="https://s3.console.aws.amazon.com/s3/buckets/paulhtremblaypublic/noaa_data/?region=us-east-1&amp;tab=overview">https://s3.console.aws.amazon.com/s3/buckets/paulhtremblaypublic/noaa_data/?region=us-east-1&amp;tab=overview</a></li>
<li><a class="reference external" href="https://s3-us-west-2.amazonaws.com/paulhtremblaypublic/noaa_data/us_stations_90_sample_small.csv">https://s3-us-west-2.amazonaws.com/paulhtremblaypublic/noaa_data/us_stations_90_sample_small.csv</a></li>
<li><a class="reference external" href="https://s3-us-west-2.amazonaws.com/paulhtremblaypublic/noaa_data/us_stations_90_sample_small.txt">https://s3-us-west-2.amazonaws.com/paulhtremblaypublic/noaa_data/us_stations_90_sample_small.txt</a></li>
<li><a class="reference external" href="https://s3-us-west-2.amazonaws.com/paulhtremblaypublic/noaa_data/us_stations_90s_sample_big.csv">https://s3-us-west-2.amazonaws.com/paulhtremblaypublic/noaa_data/us_stations_90s_sample_big.csv</a></li>
<li><a class="reference external" href="https://s3-us-west-2.amazonaws.com/paulhtremblaypublic/noaa_data/us_stations_90s_sample_big.txt">https://s3-us-west-2.amazonaws.com/paulhtremblaypublic/noaa_data/us_stations_90s_sample_big.txt</a></li>
</ul>
<p>cat ../data/simple_work_count_words.txt | ./mapper.py | sort | ./reducer.py</p>
</div>
<div class="section" id="using-parsers">
<h2>Using Parsers<a class="headerlink" href="#using-parsers" title="Permalink to this headline">¶</a></h2>
<p>For this class, we will use a parser I wrote to process each line. Using a parser will make our work easier and
allow us to focus on the important parts. Below is the code. You don’t need to understand this code or study it.
Just understand the parser converts the fixed-format into a Python dictionary.</p>
<p>Example Use:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pprint</span>
<span class="n">pp</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">parse_noaa</span>
<span class="n">line</span> <span class="o">=</span> <span class="s2">&quot;0147619760999991990071418004-15883+054517FM-12+001399999V0201201N00771220001CN0300001N9+02421+02231101821ADDAA106000091AG10999GA1021+007509089GF102991021081008001001001KA1120N+99999MD1999999+0081REMSYN029333   20282 58008 82825 918/8EQDQ01 +02822ATMN  &quot;</span>
<span class="n">results_dict</span> <span class="o">=</span> <span class="n">parse_noaa</span><span class="o">.</span><span class="n">parse_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="n">pp</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">results_dict</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The result:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>   <span class="s1">&#39;air_temperature_observation_air_temperature&#39;</span><span class="p">:</span> <span class="mf">24.2</span><span class="p">,</span>
   <span class="s1">&#39;air_temperature_observation_air_temperature_quality_code&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span>
   <span class="s1">&#39;air_temperature_observation_dew_point_quality_code&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span>
   <span class="s1">&#39;air_temperature_observation_dew_point_temperature&#39;</span><span class="p">:</span> <span class="mf">22.3</span><span class="p">,</span>
   <span class="s1">&#39;atmospheric_pressure_observation_sea_level_pressure&#39;</span><span class="p">:</span> <span class="mf">1018.2</span><span class="p">,</span>
   <span class="s1">&#39;atmospheric_pressure_observation_sea_level_pressure_quality_code&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span>
   <span class="s1">&#39;fixed_weather_station_call_letter_identifier&#39;</span><span class="p">:</span> <span class="s1">&#39;99999&#39;</span><span class="p">,</span>
   <span class="s1">&#39;fixed_weather_station_ncei_wban_identifier&#39;</span><span class="p">:</span> <span class="mi">99999</span><span class="p">,</span>
   <span class="s1">&#39;fixed_weather_station_usaf_master_station_catalog_identifier&#39;</span><span class="p">:</span> <span class="s1">&#39;619760&#39;</span><span class="p">,</span>
   <span class="s1">&#39;geophysical_point_observation_additional_data_identifier&#39;</span><span class="p">:</span> <span class="s1">&#39;ADD&#39;</span><span class="p">,</span>
   <span class="s1">&#39;geophysical_point_observation_data_source_flag&#39;</span><span class="p">:</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span>
   <span class="s1">&#39;geophysical_point_observation_elevation_dimension&#39;</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
   <span class="s1">&#39;geophysical_point_observation_latitude_coordinate&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">15.883</span><span class="p">,</span>
   <span class="s1">&#39;geophysical_point_observation_longitude_coordinate&#39;</span><span class="p">:</span> <span class="mf">54.517</span><span class="p">,</span>
   <span class="s1">&#39;geophysical_report_type_code&#39;</span><span class="p">:</span> <span class="s1">&#39;FM-12&#39;</span><span class="p">,</span>
   <span class="s1">&#39;liquid_precipitation_occurrence_identifier&#39;</span><span class="p">:</span> <span class="s1">&#39;AA1&#39;</span><span class="p">,</span>
   <span class="s1">&#39;meteorological_point_observation_quality_control_process_name&#39;</span><span class="p">:</span> <span class="s1">&#39;V020&#39;</span><span class="p">,</span>
   <span class="s1">&#39;point_observation_date_time&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1990</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
   <span class="s1">&#39;sky_condition_observation_cavok_code&#39;</span><span class="p">:</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span>
   <span class="s1">&#39;sky_condition_observation_ceiling_determination_code&#39;</span><span class="p">:</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span>
   <span class="s1">&#39;sky_condition_observation_ceiling_height_dimension&#39;</span><span class="p">:</span> <span class="mi">22000</span><span class="p">,</span>
   <span class="s1">&#39;sky_condtion_observation_ceiling_quality_code&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
   <span class="s1">&#39;total_variable_characters&#39;</span><span class="p">:</span> <span class="mi">147</span><span class="p">,</span>
   <span class="s1">&#39;visibility_observation_distance_dimension&#39;</span><span class="p">:</span> <span class="mi">30000</span><span class="p">,</span>
   <span class="s1">&#39;visibility_observation_distance_quality_code&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
   <span class="s1">&#39;visibility_observation_quality_variability_code&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
   <span class="s1">&#39;visibility_observation_variability_code&#39;</span><span class="p">:</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span>
   <span class="s1">&#39;wind_observation_direction_angle&#39;</span><span class="p">:</span> <span class="mi">120</span><span class="p">,</span>
   <span class="s1">&#39;wind_observation_direction_quality_code&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
   <span class="s1">&#39;wind_observation_speed_quality_code&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
   <span class="s1">&#39;wind_observation_speed_rate&#39;</span><span class="p">:</span> <span class="mi">77</span><span class="p">,</span>
   <span class="s1">&#39;wind_observation_type_code&#39;</span><span class="p">:</span> <span class="s1">&#39;N&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>&lt;&lt; <a class="reference internal" href="lesson4.html#lesson4"><span class="std std-ref">Introduction to NOAA Dataset</span></a> | <a class="reference internal" href="lesson4_3.html#lesson4-3"><span class="std std-ref">Using Map Reduce to find the average tempeartures for each state</span></a>  &gt;&gt;</p>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction to BIG DATA 110 A</a></li>
<li class="toctree-l1"><a class="reference internal" href="super_hero.html">Super Hero</a></li>
<li class="toctree-l1"><a class="reference internal" href="places_to_visit.html">Places To Visit</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson1_2.html">Slow Data = No Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson2.html">Lesson 2: Setting Up Your Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson2_2.html">Downloading X2GO Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson2_3.html">Install: Choosing Languange</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson2_4.html">Install: Accpeting License</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson2_5.html">Install: Choosing Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson2_6.html">Install: Choosing Location</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson2_7.html">Install: Clicking Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson2_8.html">Install: Showing Progress</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson2_9.html">Install: Finishing</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson2_10.html">Install: Allowing SSH Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson2_11.html">Install: Accepting SSH Key</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson2_12.html">Install: Allowing Acess (2)</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson2_13.html">Run X2GO: Claiming Image</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson2_14.html">Run X2GO: Choosing XFCE</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson2_15.html">Run X2GO: Clicking Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson2_16.html">Run X2GO: Putting in Password</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson2_17.html">Configure Image</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson3.html">Lesson 3: Map/Reduce</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson3_2.html">Simple word Count Non Big Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson3_3.html">Map/Reduce Word Count Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson3_4.html">Executing Example with Bash</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson3_5.html">Simple word count with Hadoop</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson4.html">Introduction to NOAA Dataset</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">NOAA Format</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction-to-the-noaa-fixed-character-format">Introduction to the NOAA fixed character format</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-parsers">Using Parsers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="lesson4_3.html">Using Map Reduce to find the average tempeartures for each state</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson4_4.html">Using Map Reduce to find the average tempeartures for each state (2)</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson4_5.html">Creating a Geographical Map from our Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson5.html">Lesson 5: Map Reduce with Multiple Steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson5_2.html">Illustrating the Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson5_3.html">Architecture Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson5_4.html">Architecture of Nodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson5_5.html">Mapper For stations</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson5_6.html">Reducer For stations</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson5_7.html">Mapper for temperature ranges</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson5_8.html">Reducer for temperature ranges</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson5_8_1.html">Executing and examining the Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson5_9.html">Summary Map Reduce</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson5_10.html">Input/Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson5_11.html">Input/Output (2)</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson5_12.html">A Short Intro to Functional Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson5_13.html">A Short Intro to Lazy Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson6.html">Lesson 6 Introduction to Spark</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson6_2.html">Architecture of Spark</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson6_3.html">Simple Word Count in Spark</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson6_4.html">Architecture behind simple word count</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson6_5.html">Anatomy Behind A Spark Job</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson6_6.html">Anatomy Behind A Spark Job (2)</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson6_7.html">Class Exercises: map</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson6_8.html">Class Exercises: filter</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson6_9.html">Class Exercises: sample</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson6_10.html">Class Exercises: union</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson6_11.html">Class Exercises:</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson6_12.html">Class Exercises: intersection</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson6_13.html">Class Exercises: distinct</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson6_14.html">Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson7.html">Input into Spark and Tranformatons</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson7_2.html">File Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson7_3.html">Reading in multiple files</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson7_4.html">Reading in CSV files</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson7_5.html">Outputing Contents of an RDD</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson7_6.html">Getting the Average Temperature Per State with RDD</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson7_7.html">Getting the Average Temperature Per Country with RDD</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson7_8.html">Spark RDD in detail</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson7_9.html">Questions/Exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson7_9.html#class-exercise">Class Exercise</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson7_10.html">Partitioning with  groupByKey</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson7_11.html">groupByKey: Architecture Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson7_12.html">groupByKey: Spark code</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson8.html">Spark DataFrames</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson8_2.html">Overview DataFrames</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson8_3.html">Creating DataFrames: CSV</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson8_4.html">Creating DataFrames: From RDD</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson8_5.html">Cleaning up a Dataframe</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson8_6.html">Executing SQL on a Dataframe</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson8_7.html">Average Temperature for each State with a Dataframe using SQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson8_8.html">Anatomy of Dataframes</a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="lesson4.html" title="Introduction to NOAA Dataset"
              >previous</a> |
            <a href="lesson4_3.html" title="Using Map Reduce to find the average tempeartures for each state"
              >next</a> |
            <a href="genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="_sources/lesson4_2.rst.txt"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Henry Tremblay.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>